<!-- src/app/components/task-list/task-list.component.html -->
<div class="task-list-container">
  <header class="task-header">
    <h1>To-Do List pour Professionnels de Sant√©</h1>
    <p>G√©rez vos t√¢ches et suivez leur progression</p>
  </header>

  <app-task-form (taskCreated)="onTaskCreated($event)"></app-task-form>

  <div class="tasks-section">
    <div class="section-header">
      <h2>Liste des T√¢ches</h2>
      <button 
        (click)="refreshTasks()" 
        class="btn-refresh" 
        [disabled]="(loading$ | async) === true">
        <span *ngIf="loading$ | async; else refreshText">
          <span class="spinner"></span> Chargement...
        </span>
        <ng-template #refreshText>Actualiser</ng-template>
      </button>
    </div>

    <!-- Indicateur de chargement global -->
    <div *ngIf="loading$ | async" class="loading-state">
      <div class="spinner"></div>
      <p>Chargement des t√¢ches...</p>
    </div>

    <!-- Message d'erreur global -->
    <div *ngIf="error" class="error-message">
      <div class="error-icon">‚ö†Ô∏è</div>
      <div class="error-content">
        <p>{{ error }}</p>
        <button (click)="refreshTasks()" class="btn-retry">R√©essayer</button>
      </div>
    </div>

    <!-- Contenu principal lorsque ni chargement ni erreur -->
    <ng-container *ngIf="!(loading$ | async) && !error">
      <!-- Utilisation de l'async pipe pour obtenir les t√¢ches -->
      <ng-container *ngIf="tasks$ | async as tasks">
        <!-- Affichage si des t√¢ches existent -->
        <div class="tasks" *ngIf="tasks.length > 0">
          <div class="tasks-count">
            {{ tasks.length }} t√¢che(s) au total
          </div>
          
          <app-task-item 
            *ngFor="let task of tasks; trackBy: trackByTaskId"
            [task]="task"
            (statusChanged)="onStatusChanged($event)">
          </app-task-item>
        </div>

        <!-- Message si aucune t√¢che -->
        <div *ngIf="tasks.length === 0" class="empty-state">
          <div class="empty-icon">üìã</div>
          <h3>Aucune t√¢che pour le moment</h3>
          <p>Ajoutez votre premi√®re t√¢che en utilisant le formulaire ci-dessus.</p>
        </div>
      </ng-container>
    </ng-container>
  </div>
</div>
